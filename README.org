gocool
======

Go implementation of the Cool programming language.

* MIPS registers
|----------------+--------------+------------------------------------+-------------------|
| Number         | Name         | Function                           | Callee preserves? |
|----------------+--------------+------------------------------------+-------------------|
| $0             | zero         | always has value zero              |                   |
| $1             | at           | assembler temporary                |                   |
| $2-$3          | v0,v1        | function results. Can be temporary |                   |
| $4-$7          | a0,a1,a2,a3  | function arguments                 |                   |
| $8-$15,$24,$25 | t0,...,t7,t9 | temporary registers                |                   |
| $16-$23        | s0,...,s7    | saved registers                    | Yes               |
| $26,$27        | k0,k1        | Reserved for OS kernel             |                   |
| $28            | gp           | global pointer                     | Yes               |
| $29            | sp           | stack pointer                      | Yes               |
| $30            | fp           | frame pointer                      | Yes               |
| $31            | ra           | return address                     |                   |
|----------------+--------------+------------------------------------+-------------------|

* Code generation
Stack machine with accumulator.

Accumulator: $a0: holds result of last expression evaluation.
$s0 holds a stored copy of "self".
$sp points to next location in stack (so $sp+4 is the top of the stack)
$t0, $t1, $t2 are temporary registers.

** Activation Record
- Return address
- Old frame pointer
- n arguments
- NT(e) temporary locations

| arg_1          |                 |
| ⋮              |                 |
| arg_n          |                 |
|----------------+-----------------|
| Old FP         | <-- SP on entry |
| Return address |                 |
| Temp NT(e)     |                 |
| ⋮              |                 |
| Temp 1         | <-- New FP      |
|                | <-- New SP      |

** Object layout

| -4 | FFFF - garbage collector tag  |
|  0 | class tag                     |
|  4 | object size (in 32-bit words) |
|  8 | dispatch pointer              |
| 12 | attributes                    |
|  ⋮ | ⋮                             |

Strings:

| 12 | Length: pointer to an Int                            |
| 16 | Characters, nul-terminated, zero-padded to next word |
|  ⋮ | ⋮                                                    |

